<div class="container">
  <div class="header transfer">
    <div class="invoke-type">
      Â· {{ "SpendingCapRequest" | translate | async }}
    </div>
    <div class="address-group contract-interaction">
      <copy [value]="txParams?.from">
        <div class="item">
          <img class="avatar" [avatar]="txParams?.from" />
          <div class="name-group">
            <p class="name">{{ encryptWallet.name }}</p>
            <p>{{ txParams?.from | longStr : 10 }}</p>
          </div>
        </div>
      </copy>
    </div>
  </div>
  <div class="tabs-container">
    <span
      [class]="{ selected: tabType === 'details' }"
      (click)="tabType = 'details'"
    >
      {{ "details" | translate | async }}
    </span>
    <span [class]="{ selected: tabType === 'data' }" (click)="tabType = 'data'">
      {{ "data" | translate | async }}
    </span>
  </div>
  <div class="content details" *ngIf="tabType === 'details'">
    <div class="request-info">
      <div class="request-info-item">
        <div class="label">
          {{ "SpendingCap" | translate | async }}
          <tooltip
            placement="topLeft"
            [tip]="
              'approveNormalTip'
                | translate
                  : { amount: approveAmount, symbol: assetDetails?.symbol }
                | async
            "
          >
            <img src="assets/images/common/tooltip.svg" alt="" />
          </tooltip>
        </div>
        <div class="edit-amount">
          <img
            (click)="openEditApproveCapDialog()"
            class="edit"
            src="assets/images/common/edit.svg"
          />
          <span>{{ approveAmount }}</span>
          <div class="asset-logo">
            <token-logo
              customClass="list edit-amount"
              [assetId]="txParams.to"
              [chainType]="'NeoX'"
              [symbol]="assetDetails?.symbol"
              [neoXChainId]="neoXNetwork.chainId"
            ></token-logo>
            {{ assetDetails?.symbol }}
          </div>
        </div>
      </div>
      <div class="request-info-item" *ngIf="tokenData?.args?._spender">
        <div class="label">
          {{ "Spender" | translate | async }}
          <tooltip placement="topLeft" [tip]="'spenderTip' | translate | async">
            <img src="assets/images/common/tooltip.svg" alt="" />
          </tooltip>
        </div>
        <copy [value]="tokenData.args._spender">
          <span class="to-address">
            {{ tokenData.args._spender | longStr : 6 }}
            <img theme src="assets/images/common/copy.svg" />
          </span>
        </copy>
      </div>
    </div>

    <evm-estimate-error *ngIf="estimateGasError"></evm-estimate-error>

    <div class="request-info">
      <div class="request-info-item">
        <span class="label">{{ "Network" | translate | async }}</span>
        <span>{{ neoXNetwork.name }}</span>
      </div>
      <div class="request-info-item">
        <div class="label">
          {{ "RequestFrom" | translate | async }}
          <tooltip
            placement="topLeft"
            [tip]="'requestFromTip' | translate | async"
          >
            <img src="assets/images/common/tooltip.svg" alt="" />
          </tooltip>
        </div>
        <span>{{ locationOrigin }}</span>
      </div>
      <div *ngIf="txParams?.to" class="request-info-item">
        <div class="label">
          {{ "InteractingWith" | translate | async }}
          <tooltip
            placement="topLeft"
            [tip]="'interactionWithTip' | translate | async"
          >
            <img src="assets/images/common/tooltip.svg" alt="" />
          </tooltip>
        </div>
        <copy [value]="txParams?.to">
          <span class="to-address">
            {{ txParams?.to | longStr : 6 }}
            <img theme src="assets/images/common/copy.svg" />
          </span>
        </copy>
      </div>
      <div class="request-info-item">
        <div class="label">
          {{ "Method" | translate | async }}
          <tooltip placement="topLeft" [tip]="'methodTip' | translate | async">
            <img src="assets/images/common/tooltip.svg" alt="" />
          </tooltip>
        </div>
        <span>{{ tokenData?.name }}</span>
      </div>
    </div>

    <div class="fee-group">
      <evm-fee
        [txParams]="newTxParams ?? txParams"
        [symbol]="neoXNetwork.symbol"
        [siteNeoXFeeInfo]="siteNeoXFeeInfo"
        [place]="'dapp'"
        (returnFee)="updateEvmFee($event)"
      >
      </evm-fee>
      <p class="value-rate">
        {{ rate.fee | numberFixed : 2 }} {{ rate.rateCurrency }}
      </p>
    </div>
    <evm-custom-nonce
      [default]="nonceInfo?.nonce"
      (changeNonceEvent)="changeNonce($event)"
    ></evm-custom-nonce>

    <evm-gas-error
      *ngIf="insufficientFunds"
      [networkName]="neoXNetwork.name"
      [symbol]="neoXNetwork.symbol"
    ></evm-gas-error>
    <evm-pending-warning
      *ngIf="nonceInfo?.pendingTxs"
      [count]="nonceInfo.pendingTxs"
    ></evm-pending-warning>
  </div>

  <div class="content data" *ngIf="tabType === 'data'">
    <p class="title">
      FUNCTION TYPE:
      <span class="value">{{ tokenData?.name }}</span>
    </p>
    <div class="hex-label">
      HEX DATA: <span class="value">{{ hexDataLength }} BYTES</span>
      <copy [value]="txParams.data">
        <img class="copy" theme src="assets/images/common/copy.svg" alt="" />
      </copy>
    </div>
    <p class="json-box serialize">{{ txParams.data }}</p>
  </div>
  <div class="btn-group">
    <button class="cancel" (click)="exit()">
      {{ "cancel" | translate | async }}
    </button>
    <button
      class="confirm"
      [ngClass]="{ disabled: !nonceInfo || insufficientFunds }"
      (click)="confirm()"
    >
      {{ "yes" | translate | async }}
    </button>
  </div>
</div>
